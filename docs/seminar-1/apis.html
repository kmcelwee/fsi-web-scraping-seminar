<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Intro to APIs - FSI Web Scraping Seminar</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Intro to APIs | FSI Web Scraping Seminar</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="Intro to APIs" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="[WIP] A collection of web scraping resources for the 2021 FSI summer course Humanistic Approaches to Media and Data." /> <meta property="og:description" content="[WIP] A collection of web scraping resources for the 2021 FSI summer course Humanistic Approaches to Media and Data." /> <link rel="canonical" href="/seminar-1/apis" /> <meta property="og:url" content="/seminar-1/apis" /> <meta property="og:site_name" content="FSI Web Scraping Seminar" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Intro to APIs" /> <script type="application/ld+json"> {"description":"[WIP] A collection of web scraping resources for the 2021 FSI summer course Humanistic Approaches to Media and Data.","@type":"WebPage","url":"/seminar-1/apis","headline":"Intro to APIs","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> FSI Web Scraping Seminar </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/seminar-1" class="nav-list-link">Seminar 1</a><ul class="nav-list "><li class="nav-list-item "><a href="/seminar-1/python" class="nav-list-link">Python programming refresher</a></li><li class="nav-list-item "><a href="/seminar-1/colab" class="nav-list-link">Intro to Colab</a></li><li class="nav-list-item "><a href="/seminar-1/json-and-csv" class="nav-list-link">File formats</a></li><li class="nav-list-item "><a href="/seminar-1/tweepy" class="nav-list-link">Intro to Tweepy</a></li><li class="nav-list-item active"><a href="/seminar-1/apis" class="nav-list-link active">Intro to APIs</a></li><li class="nav-list-item "><a href="/seminar-1/munge-json" class="nav-list-link">Data cleaning</a></li><li class="nav-list-item "><a href="/seminar-1/examples" class="nav-list-link">How to develop a research question</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search FSI Web Scraping Seminar" aria-label="Search FSI Web Scraping Seminar" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/seminar-1">Seminar 1</a></li> <li class="breadcrumb-nav-list-item"><span>Intro to APIs</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="introduction-to-working-with-apis"> <a href="#introduction-to-working-with-apis" class="anchor-heading" aria-labelledby="introduction-to-working-with-apis"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Introduction to working with APIs </h1> <p>An API (“Application Programming Interface”, you don’t need to remember that, no one does.) is a collection of commands you can issue over the internet to collect data from websites. Collecting this data is usually done over code, but you can also see this data by just visiting URLs in your browser.</p> <p>This URL <a href="https://api.github.com/users/princeton-cdh/repos">https://api.github.com/users/princeton-cdh/repos</a> will list information about all the code under the CDH’s GitHub account. (If you’re in Firefox, click on the “Raw Data” button to see things more clearly.) This is JSON data like any other, and you could write a quick script to list out all the codebases we’ve worked on.</p> <p>The power of this is that as long as you follow the formula above:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://api.github.com/users/{USER}/repos
</code></pre></div></div> <p>you can get the public code bases on <em>any</em> GitHub user. From that information we could then get a count of all issues on all the repositories so that we know how much work is left to do. GitHub is pretty complicated, but here’s a link to the <a href="https://docs.github.com/en/rest/guides/getting-started-with-the-rest-api">API documentation</a>.</p> <p>If we didn’t have an API, to accomplish something similar we’d have to scrape the CDH’s <a href="https://github.com/Princeton-CDH">profile page</a>, which would be <em>a lot</em> harder. APIs store information in a clean, consistent way that makes it easy to collect information (for better and for worse.)</p> <h2 id="wrappers"> <a href="#wrappers" class="anchor-heading" aria-labelledby="wrappers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Wrappers </h2> <p>We will be working with <code class="language-plaintext highlighter-rouge">tweepy</code> a library that helps us to work with the API in python. This is an example of a <strong>wrapper</strong>. APIs are built to work with any language— all you need is an internet connection. But as we’ll see, it can be clumsy to work directly with the API, so programmers called API wrappers like <code class="language-plaintext highlighter-rouge">tweepy </code> to make their code cleaner and easier to use.</p> <p>If you’re ever looking to work with an API, let’s take Reddit as an example, it’s worth googling “reddit api python wrapper”, and you’ll come across libraries that other people have used to connect to Reddit’s API. For python, I recommend <a href="https://github.com/praw-dev/praw"><code class="language-plaintext highlighter-rouge">praw</code></a>.</p> <p>Wrappers are simply supposed to simply make your life easier, but it’s possible that you’re going to work with APIs that don’t have wrappers in the language you need. The New York Times API, for example, doesn’t have a good python wrapper. If you make one, publish it online, and you can help other programers!</p> <h2 id="api-limitations"> <a href="#api-limitations" class="anchor-heading" aria-labelledby="api-limitations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> API Limitations </h2> <p>Rate limits are an important concept in order to work safely with APIs. When companies like Spotify or Twitter open up their servers to connect with other computers, they want to impose rules to make sure no one spams their servers or scrapes their entire database too quickly. When considering how to pursue a research question, keep “rate limiting” and “data limiting” in mind.</p> <h3 id="rate-limiting"> <a href="#rate-limiting" class="anchor-heading" aria-labelledby="rate-limiting"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rate limiting </h3> <p>Rate limits are kind of like speed limits imposed by an API. If Twitter allowed anybody to scrape every single tweet ever, it would place immense strain on their infrastructure (and since data is their main commodity, they can sell this access to corporations for a hefty price.)</p> <p>Rate limits <a href="https://developer.twitter.com/en/docs/twitter-api/rate-limits">are documented here.</a> We have created one app, so in each 15-minute window we can execute 300 searches.</p> <p><img src="img/rate-limiting.png" alt="" /></p> <p>Since each search contains a maximum of 200 tweets, we can get 60,000 tweets (!) in 15 minutes. When just starting out, rarely will one’s research questions reach the limit, but if you need a lot of data for your analysis, your scrape may take days to execute if the API’s rate limit is especially low. Smaller companies probably will have stronger limitations on how much data you can collect from their site. In the case of Facebook and TikTok, you can’t scrape data at all.</p> <h3 id="data-limiting"> <a href="#data-limiting" class="anchor-heading" aria-labelledby="data-limiting"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Data Limiting </h3> <p>As discussed previously, this data is highly valuable, and companies like Facebook have decided to cut off developers from accessing that data. Spotify won’t allow programmers to access counts of how long a song has been listened to (even though it’s available in their UI.) Twitter limits users to only the latest 3200 tweets when scraping a user’s timeline. You can only get the latest 100 retweets on a tweet <a href="https://levels.io/giveaway/">which has led to problems in the past</a>.</p> <p>When pursuing a research question, make sure that the resources that you need to answer that question willl be fully included in the dataset you’re collecting <a href="https://towardsdatascience.com/fake-follower-calculators-misinform-users-journalists-with-dubious-statistics-659b60fc4d5a">otherwise you may be misinforming people.</a></p> <h2 id="secret-keys"> <a href="#secret-keys" class="anchor-heading" aria-labelledby="secret-keys"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Secret Keys </h2> <p>If someone has your public and private key, they can log in to the API and make it appear like you are abusing the rate limit or even post tweets as you (!). Never publish your private key anywhere.</p> <h2 id="legal"> <a href="#legal" class="anchor-heading" aria-labelledby="legal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Legal </h2> <p><strong>I AM NOT A LAWYER, THIS IS NOT LEGAL ADVICE</strong></p> <p>As long as you’re using the API, you’re not doing anything illegal, but web scraping in general (say if I wrote a script to scrape all the email addresses from https://www.princeton.edu/) is quasi-illegal. We won’t go into how to scrape outside of APIs in these seminars, but consider that making thousands of requests to any website can cripple its infrastructure. This is called a <a href="https://www.paloaltonetworks.com/cyberpedia/what-is-a-denial-of-service-attack-dos">Denial of Service Attack (DoS).</a> So it’s best to follow <a href="https://data-lessons.github.io/library-webscraping-DEPRECATED/05-conclusion/">best practices</a> when collecting data outside the formal API process.</p> <h2 id="ethics"> <a href="#ethics" class="anchor-heading" aria-labelledby="ethics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ethics </h2> <p>Working with Twitter data most users know that Twitter is a public place, and anyone can see their tweets. Even better, working with Reddit, people are operating under the assumption of anonymity, so there are fewer ethical considerations.</p> <p>But when you send a tweet, you may assume that it’s public, but how much control should you have after posting to a platform?</p> <p>🤔 <strong>How would you feel if a tweet you wrote…</strong></p> <ul> <li>…was included as an example in a book about internet culture?</li> <li>…was used to train a machine learning model to detect sarcasm?</li> <li>…included a picture that was used to train a facial recognition algorithm?</li> </ul> <p>(All these are real-life examples.)</p> <p>As you develop your research question, consider the ethical implications of collecting this data. If you scraped a user’s timeline, was this person a public figure? If you scraped all tweets that used a certain hashtag, how many people are you collecting data from? Did any of these people expect their data to be collected by a first years at Princeton?</p> <h3 id="popular-apis"> <a href="#popular-apis" class="anchor-heading" aria-labelledby="popular-apis"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Popular APIs </h3> <ul> <li><a href="https://www.mediawiki.org/wiki/API:Main_page">Wikipedia</a></li> <li><a href="https://www.reddit.com/dev/api">Reddit</a></li> <li><a href="https://developer.spotify.com/documentation/web-api/">Spotify</a></li> <li><a href="https://github.com/public-apis/public-apis">more…</a></li> </ul> <h2 id="the-twitter-api"> <a href="#the-twitter-api" class="anchor-heading" aria-labelledby="the-twitter-api"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The Twitter API </h2> <h3 id="general-structure"> <a href="#general-structure" class="anchor-heading" aria-labelledby="general-structure"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> General structure </h3> <p>Twitter is exceptional as a social media company because it gives researchers access to almost its entire site. Twitter allows you to access the following databases:</p> <ul> <li>Tweets</li> <li>Users</li> <li>Direct Messages</li> <li>Lists</li> <li>Trends</li> <li>Media</li> <li>Places</li> </ul> <p>📚 <strong>Given these databases, what kind of questions could you ask?</strong></p> <h3 id="what-is-a-twitter-id"> <a href="#what-is-a-twitter-id" class="anchor-heading" aria-labelledby="what-is-a-twitter-id"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What is a Twitter ID? </h3> <p>A Twitter ID is a unique identifier for each tweet. Having a unique ID is important for Twitter to store the thousands of tweets posted every second. If you have the ID of a tweet (perhaps from JSON data that you’ve scraped) and you want to see the original tweet in your browser, just follow this recipe:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://twitter.com/{PROFILE}/status/{TWEET_ID}
# Example:
https://twitter.com/mattxiv/status/1368246126302945284
</code></pre></div></div> <p>If you’d like, try to use this tweet ID <code class="language-plaintext highlighter-rouge">1116487177364365313</code> to find the original Tweet. Often, organizations like <a href="https://www.docnow.io/">Documenting the Now</a> will store tweet IDs only, and then researchers can “rehydrate” those IDs. Since there’s a limited time window to collect tweets during momentous occasions, you’re welcome to contribute to resources like these to preserve how people reacted online. <a href="https://catalog.docnow.io/">Check out Documenting the Now’s catalog.</a></p> <h2 id="existing-datasets"> <a href="#existing-datasets" class="anchor-heading" aria-labelledby="existing-datasets"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Existing datasets </h2> <p>Before scraping your own datasets, consider that other people may have had similar questions as you. Check out these sites before beginning your work to see if other researchers can save you time! People who create datasets want them to be put to good use, so they’ll try to share them as widely as possible.</p> <ul> <li>Wikipedia has a lot of tabular data you can draw from!</li> <li><a href="https://github.com/">Github</a> is often used for code, but researchers will often post their datasets there as well</li> <li><a href="https://catalog.docnow.io/">Documenting the Now</a>, as mentioned above, has a huge resource of tweets</li> <li><a href="https://www.reddit.com/r/datasets">r/datasets</a> contains a lot of datasets that people compiled for their research or for fun.</li> </ul> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
